<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  
  <title>Passing a table using Nav Automation | Codethug</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I just had someone comment on my previous blog post asking how to pass a table using Nav Automation. Great question. You can pass complex objects using Nav Automation, but only ones that you define (o">
<meta property="og:type" content="article">
<meta property="og:title" content="Passing a table using Nav Automation">
<meta property="og:url" content="http://codethug.com/2010/05/28/passing-a-table-using-nav-automation/index.html">
<meta property="og:site_name" content="Codethug">
<meta property="og:description" content="I just had someone comment on my previous blog post asking how to pass a table using Nav Automation. Great question. You can pass complex objects using Nav Automation, but only ones that you define (o">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2021-03-17T03:54:50.023Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Passing a table using Nav Automation">
<meta name="twitter:description" content="I just had someone comment on my previous blog post asking how to pass a table using Nav Automation. Great question. You can pass complex objects using Nav Automation, but only ones that you define (o">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,400,600" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-61949305-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-61949305-1');
</script>
<!-- End Google Analytics -->


</head>
</html>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo">
        <!-- <i class="logo"></i> -->
        <span class="site-title">Codethug</span>
      </a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        <div class="profile" id="profile-nav">
          <a id="profile-anchor" href="javascript:;"><img class="avatar" src="https://s.gravatar.com/avatar/e18193ec07249288118577b3b51c8834?s=128"><i class="fa fa-caret-down"></i></a>
        </div>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://codethug.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
      
        <td><a class="main-nav-link" href="/">Home</a></td>
      
        <td><a class="main-nav-link" href="/archives">Archives</a></td>
      
      <td>
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://codethug.com"></form>
      </td>
      </tr>
    </table>
  </div>
  
</header>

    <div class="outer">
      <aside id="profile">
  <div class="inner profile-inner">
  	<div class="base-info profile-block">
		  <img id="avatar" src="https://s.gravatar.com/avatar/e18193ec07249288118577b3b51c8834?s=128">
      <h2 id="name">Tim Larson</h2>
      <h3 id="title">Codethug</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Salt Lake City, UT</span>
      <!-- <a id="follow" href="null">FOLLOW</a> -->
  	</div>
    <!--<div class="article-info profile-block">
      <div class="article-info-block">
        59
        <span>posts</span>
      </div>
      <div class="article-info-block">
        0
        <span>tag</span>
      </div>
    </div>-->
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
        
          <td><a href="http://github.com/codethug" title="github"><i class="fa fa-github"></i></a></td>
        
          <td><a href="http://twitter.com/codethug" title="twitter"><i class="fa fa-twitter"></i></a></td>
        
          <td><a href="http://linkedin.com/in/larsontim" title="linkedin"><i class="fa fa-linkedin"></i></a></td>
        
          <td><a href="http://stackoverflow.com/users/133852/codethug" title="stack-overflow"><i class="fa fa-stack-overflow"></i></a></td>
        
          <td><a href="http://feeds.feedburner.com/CodeThug" title="rss"><i class="fa fa-rss"></i></a></td>
        
        </tr>
      </table>
    </div>
  </div>
</aside>

      <section id="main"><article id="post-passing-a-table-using-nav-automation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Passing a table using Nav Automation
    </h1>
  

        <div class="article-meta">
          <div class="article-date">
  <i class="fa fa-calendar"></i>
  <a href="/2010/05/28/passing-a-table-using-nav-automation/">
    <time datetime="2010-05-28T18:46:00.000Z" itemprop="datePublished">2010-05-28</time>
  </a>
</div>
          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/Uncategorized/">Uncategorized</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>I just had someone comment on my previous blog post asking how to pass a table using Nav Automation. Great question.</p>
<p>You can pass complex objects using Nav Automation, but only ones that you define (or that have been explicitly written to work with COM). This means that you can’t pass a DataTable object, but you can create your own implementation of a DataTable object and pass it.</p>
<p>In your complex object, you have to explicitly define every property and method that you need to call on that complex object and surface those properties and methods through COM.</p>
<a id="more"></a>
<p>Enough talk. Let’s see the code. Here is some sample .Net code showing how to pass a table of addresses.</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.InteropServices;</span><br><span class="line"><span class="keyword">using</span> System.Security.Cryptography;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="keyword">using</span> System.ComponentModel;</span><br><span class="line"></span><br><span class="line">[<span class="meta">assembly: ClassInterface(ClassInterfaceType.AutoDual)</span>]</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Tim.NavAutomation</span></span><br><span class="line">&#123;</span><br><span class="line">  [<span class="meta">InterfaceType(ComInterfaceType.InterfaceIsIDispatch)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-a39f-4fde-9779-fc46749a7ff0”)</span>]</span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAddressDetail</span></span><br><span class="line">  &#123;</span><br><span class="line">    [<span class="meta">DispId(13200)</span>]</span><br><span class="line">    <span class="keyword">string</span> Address1 &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13201)</span>]</span><br><span class="line">    <span class="keyword">string</span> Address2 &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13202)</span>]</span><br><span class="line">    <span class="keyword">string</span> City &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13203)</span>]</span><br><span class="line">    <span class="keyword">string</span> State &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13204)</span>]</span><br><span class="line">    <span class="keyword">string</span> PostCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13205)</span>]</span><br><span class="line">    <span class="keyword">string</span> Country &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">DispId(12306)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsValidAddress</span>(<span class="params"></span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-9e1f-4b4e-9a27-5e583cad9acf”)</span>]</span><br><span class="line">  [<span class="meta">ClassInterface(ClassInterfaceType.None)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AddressDetail</span> : <span class="title">IAddressDetail</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _Address1;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Address1</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _Address1; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _Address1 = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _Address2;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Address2</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _Address2; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _Address2 = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _City;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> City</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _City; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _City = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _State;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> State</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _State; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _State = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _PostCode;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> PostCode</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _PostCode; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _PostCode = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">string</span> _Country;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">string</span> Country</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span> &#123; <span class="keyword">return</span> _Country; &#125;</span><br><span class="line">      <span class="keyword">set</span> &#123; _Country = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">IsValidAddress</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">      <span class="comment">// This is where you can put your own</span></span><br><span class="line">      <span class="comment">// logic to validate that the address</span></span><br><span class="line">      <span class="comment">// is valid (i.e., check with USPS</span></span><br><span class="line">      <span class="comment">// web service, etc.)</span></span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">InterfaceType(ComInterfaceType.InterfaceIsIDispatch)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-59f6-4d1e-803e-080c09572c52”)</span>]</span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAddressTable</span></span><br><span class="line">  &#123;</span><br><span class="line">    [<span class="meta">DispId(13210)</span>]</span><br><span class="line">    <span class="keyword">int</span> Length &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    [<span class="meta">DispId(13211)</span>]</span><br><span class="line">    <span class="function">AddressDetail <span class="title">Item</span>(<span class="params"><span class="keyword">int</span> i</span>)</span>;</span><br><span class="line">    [<span class="meta">DispId(13212)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Add</span>(<span class="params">Address item</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-df87-4ab5-80ac-d979e38a3a58”)</span>]</span><br><span class="line">  [<span class="meta">ClassInterface(ClassInterfaceType.None)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AddressTable</span> : <span class="title">IAddressTable</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">public</span> List</span><br><span class="line">    InternalAddressTable;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> Length</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> (InternalAddressTable == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">return</span> InternalAddressTable.Count;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> TransactionDetail <span class="title">Item</span>(<span class="params"><span class="keyword">int</span> i</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">      <span class="keyword">if</span> (i &lt;&gt;= InternalAddressTable.Count)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> InternalAddressTable[i];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Add</span>(<span class="params">AddressDetail address</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">      <span class="keyword">if</span> (InternalAddressTable == <span class="literal">null</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        InternalAddressTable = <span class="keyword">new</span> List();</span><br><span class="line">      &#125;</span><br><span class="line">      InternalAddressTable.Add(Item);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">InterfaceType(ComInterfaceType.InterfaceIsIDispatch)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-6292-4F39-BB5B-1BDE0F69007B”)</span>]</span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAddressFunctions</span></span><br><span class="line">  &#123;</span><br><span class="line">    [<span class="meta">DispId(13300)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> AddressTable <span class="title">GetNewAddresses</span>(<span class="params"></span>)</span>;</span><br><span class="line">    [<span class="meta">DispId(13301)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">SendJunkMail</span>(<span class="params">AddressTable addresses</span>)</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="meta">ComVisible(true)</span>]</span><br><span class="line">  [<span class="meta">Guid(“12345678-B073-4C6A-B21E-6A19F3A7DE4E”)</span>]</span><br><span class="line">  [<span class="meta">ClassInterface(ClassInterfaceType.None)</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AddressFunctions</span> : <span class="title">IAddressFunctions</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> AddressTable <span class="title">GetNewAddresses</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">      AddressTable t = <span class="keyword">new</span> AddressTable();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Here is where you could insert your</span></span><br><span class="line">      <span class="comment">// own logic to get a table of</span></span><br><span class="line">      <span class="comment">// addresses from somewhere</span></span><br><span class="line">      AddressDetail det = <span class="keyword">new</span> AddressDetail;</span><br><span class="line">      det.Address1 = “<span class="number">123</span> Main Street”;</span><br><span class="line">      det.City = “Baltimore”;</span><br><span class="line">      det.State = “Maryland”;</span><br><span class="line">      det.PostCode = “<span class="number">01252</span>”;</span><br><span class="line">      t.Add(det);</span><br><span class="line"></span><br><span class="line">      det = <span class="keyword">new</span> AddressDetail();</span><br><span class="line">      det.Address1 = “<span class="number">5123</span> Governor Lane”;</span><br><span class="line">      det.City = “Chesterville”;</span><br><span class="line">      det.State = “Kansas”;</span><br><span class="line">      det.PostCode = “<span class="number">71321</span>”;</span><br><span class="line">      t.Add(det);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">bool</span> <span class="title">SendJunkMail</span>(<span class="params">AddressTable addresses</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">      <span class="keyword">foreach</span> (AddressDetail d</span><br><span class="line">      <span class="keyword">in</span> addresses.InternalAddressTable)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Here is where you would call some</span></span><br><span class="line">        <span class="comment">// external function to send junk</span></span><br><span class="line">        <span class="comment">// mail to each Addresse</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>So how do we work with this on the Nav side? I’m glad you asked. Here is some sample (untested) code that shows the general idea. Note that AddrTable, AddrDetail, and AddrFunc are automation objects in Nav that have been tied to the automation types defined in the .Net code from above.</p>
<p>First, we’ll show how to take a table of data and pass it to .Net so that .Net can do something with the data.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE(AddrTable);</span><br><span class="line">CREATE(AddrDetail);</span><br><span class="line">AddrDetail.Address1 := <span class="emphasis">'5432 Small Dr.'</span>;</span><br><span class="line">AddrDetail.City := "Smallsville";</span><br><span class="line">AddrDetail.State := <span class="emphasis">'NY'</span>;</span><br><span class="line">AddrDetail.PostCode := <span class="emphasis">'12345'</span>;</span><br><span class="line">AddrTable.Add(AddrDetail);</span><br><span class="line"></span><br><span class="line">CLEAR(AddrDetail);</span><br><span class="line">CREATE(AddrDetail);</span><br><span class="line">AddrDetail.Address1 := <span class="emphasis">'813 Garden Path'</span>;</span><br><span class="line">AddrDetail.City := <span class="emphasis">'Mechanicsburg'</span>;</span><br><span class="line">AddrDetail.State := <span class="emphasis">'Michigan'</span>;</span><br><span class="line">AddrDetail.PostCode := <span class="emphasis">'51238'</span>;</span><br><span class="line">AddrTable.Add(AddrDetail);</span><br><span class="line"></span><br><span class="line">CREATE(AddrFunc);</span><br><span class="line">success := AddrFunc.SendJunkMail(AddrTable);</span><br><span class="line"></span><br><span class="line">CLEAR(AddrFunc);</span><br><span class="line">CLEAR(AddrDetail);</span><br><span class="line">CLEAR(AddrTable);</span><br></pre></td></tr></table></figure>
<p>And now I’ll show how to retrieve a table of data from .Net and then do something with it in Nav</p>
<pre><code class="asciidoc">CREATE(AddrFunc);
AddrTable := AddrFunc.GetNewAddresses();
IF AddrTable.Length &amp;gt; 0 THEN BEGIN
i := 0;
REPEAT
AddrDetail := AddrTable.Item(i);
<span class="comment">// Do something with AddrDetail.Address1,</span>
<span class="comment">// AddrDetail.Address2, etc. Perhaps</span>
<span class="comment">// you could add them to the contact table.</span>
i := i + 1;
UNTIL i = AddrTable.Length;
END;
</code></pre>
<p>I hope that helps to show what you can do. Yes, it’s a pain. But that’s the nature of working with COM.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://codethug.com/2010/05/28/passing-a-table-using-nav-automation/" data-id="ckmson8gd002q3gagylna5p11" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2010/06/17/sharepoint-2007-only-their-own-permission-on-document-library/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Sharepoint 2007: &#39;Only their own&#39; permission on Document Library
        
      </div>
    </a>
  
  
    <a href="/2010/03/30/x-does-not-contain-a-definition-for-y/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">x does not contain a definition for y</div>
    </a>
  
</nav>

  
</article>


</section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">recent posts</h3>
    <div class="widget">
      <ul id="recent-post" class="no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <!-- <p class="item-category"></p> -->
              <p class="item-title"><a href="/2021/03/17/Caching-with-Attributes-in-DotNet-Core5/" class="title">Caching with Attributes in .Net Core 5</a></p>
              <p class="item-date"><time datetime="2021-03-17T18:22:57.000Z" itemprop="datePublished">2021-03-17</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <!-- <p class="item-category"></p> -->
              <p class="item-title"><a href="/2017/09/09/Mocking-Extension-Methods/" class="title">Mocking Extension Methods</a></p>
              <p class="item-date"><time datetime="2017-09-09T16:21:30.000Z" itemprop="datePublished">2017-09-09</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <!-- <p class="item-category"></p> -->
              <p class="item-title"><a href="/2017/09/07/Chrome-58-and-Self-Signed-Certificates-in-IIS/" class="title">Chrome 58 and Self Signed Certificates in IIS</a></p>
              <p class="item-date"><time datetime="2017-09-07T16:09:02.000Z" itemprop="datePublished">2017-09-07</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <!-- <p class="item-category"></p> -->
              <p class="item-title"><a href="/2016/02/19/Entity-Framework-Cache-Busting/" class="title">Entity Framework Cache Busting</a></p>
              <p class="item-date"><time datetime="2016-02-19T20:08:05.000Z" itemprop="datePublished">2016-02-19</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-inner">
              <!-- <p class="item-category"><a class="article-category-link" href="/categories/Net/">.Net</a><i class="fa fa-angle-right"></i><a class="article-category-link" href="/categories/Net/Testing/">Testing</a></p> -->
              <p class="item-title"><a href="/2015/03/20/mocking-dbset/" class="title">A Simple interface for fluently mocking a DbSet</a></p>
              <p class="item-date"><time datetime="2015-03-20T13:45:46.000Z" itemprop="datePublished">2015-03-20</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">March 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/07/">July 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/04/">April 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/02/">February 2013</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/01/">January 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/12/">December 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/11/">November 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/10/">October 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/09/">September 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/06/">June 2012</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/04/">April 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/02/">February 2012</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">July 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">June 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/10/">October 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">July 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">June 2010</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/10/">October 2009</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/03/">March 2009</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2008/12/">December 2008</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 Tim Larson<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div>
  </div>
</footer>
    


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>